<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>EstateAssist â€“ Real Estate AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
    
      

  <!-- Header -->
  <header class="navbar">
    <div class="logo">ğŸ  <span>EstateAssist</span></div>
    <div class="nav-text">AI-powered property assistance</div>
  </header>

  <!-- Main Container -->
  <main class="container">

    <!-- Hero -->
    <section class="hero">
      <h1>Find the Right Property Faster</h1>
      <p>Chat with our AI assistant to buy, rent, or explore properties.</p>
      <p class="trust">âœ” Used by local property experts â€¢ Secure & private</p>

    </section>

    <!-- Chat Card -->
    <section class="chat-card">
      <div id="chat"></div>
      <script>
        document.getElementById("chat").innerHTML =
          `<div class="bubble bot">
            ğŸ‘‹ Hi! Iâ€™m your AI real estate assistant.<br><br>
            Tell me what you're looking for â€” buy, rent, budget, or city.
          </div>`;
        </script>
        

      <div class="chat-input">
        <input id="msg" placeholder="Type your property requirementâ€¦" />

        <button onclick="send()">Send</button>
      </div>
    </section>

    <!-- Lead Card -->
    <section class="lead-card">
      <h2>ğŸ“ Request a Callback</h2>
      <p>Our property expert will contact you shortly.</p>

      <input id="name" placeholder="Your Name" />
      <input id="phone" placeholder="Phone Number" />
      <input id="email" placeholder="Email Address" />

      <button class="cta" onclick="lead()">Get Callback</button>
    </section>

  </main>

<script>
const sessionId = "user_" + Math.random().toString(36).substring(7);

function send() {
  const msg = document.getElementById("msg").value;
  if (!msg) return;

  document.getElementById("chat").innerHTML +=
    `<div class="bubble user">${msg}</div>`;

  fetch("/chat", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ message: msg, session_id: sessionId })
  })
  .then(r => r.json())
  .then(d => {
    document.getElementById("chat").innerHTML +=
      `<div class="bubble bot">${d.reply.replace(/\n/g, "<br>")}</div>`;

    document.getElementById("chat").scrollTop =
      document.getElementById("chat").scrollHeight;

    // âœ… CTA ACTIVATION (FINAL)
    if (d.show_lead_form) {
      const leadCard = document.querySelector(".lead-card");
      const ctaBtn = document.querySelector(".cta");
      const msgInput = document.getElementById("msg");

      if (leadCard) {
        leadCard.classList.add("highlight");
      }

      if (ctaBtn) {
        ctaBtn.innerText = "Get Matching Properties";
      }

      if (msgInput) {
        msgInput.disabled = true;
        msgInput.placeholder = "Please share your contact details below ğŸ‘‡";
      }
    }
  });

  document.getElementById("msg").value = "";
}




function lead() {
  fetch("/lead", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      name: name.value,
      phone: phone.value,
      email: email.value
    })
  }).then(() => alert("âœ… Thank you! Our team will contact you shortly."));
}
</script>

</body>
</html>
